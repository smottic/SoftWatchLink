<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoftWatchLink - Multi-Stream Viewer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .input-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            color: #333;
        }
        
        button {
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        button i {
            margin-right: 8px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .video-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .video-wrapper {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            transition: transform 0.3s ease;
        }
        
        .video-wrapper:hover {
            transform: scale(1.03);
        }
        
        .video-player {
            width: 100%;
            height: 200px;
            background: #000;
        }
        
        .video-info {
            padding: 15px;
        }
        
        .video-title {
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .video-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .video-controls button {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
            margin-right: 10px;
        }
        
        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background: linear-gradient(to right, #ff7e5f, #feb47b);
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        .generated-link {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            display: none;
        }
        
        .link-container {
            display: flex;
            gap: 10px;
        }
        
        .link-container input {
            flex: 1;
        }
        
        .link-container button {
            white-space: nowrap;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            font-size: 1.5rem;
        }
        
        .error {
            background: #ff6b6b;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .container {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .video-container {
                grid-template-columns: 1fr;
            }
            
            .link-container {
                flex-direction: column;
            }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1000;
        }
        
        .volume-control {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        
        .volume-control input {
            flex: 1;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-play-circle"></i> SoftWatchLink</h1>
            <p class="tagline">Multi-Stream Viewer with YouTube API Integration</p>
        </header>
        
        <div class="input-section">
            <div class="form-group">
                <label for="videoUrl"><i class="fas fa-link"></i> YouTube Video URL or ID</label>
                <input type="text" id="videoUrl" placeholder="Paste YouTube URL or Video ID (e.g., dQw4w9WgXcQ)">
                <div class="error" id="urlError">Please enter a valid YouTube URL or Video ID</div>
            </div>
            
            <div class="form-group">
                <label for="frameCount"><i class="fas fa-copy"></i> Number of Streams</label>
                <input type="number" id="frameCount" min="1" max="6" value="2" placeholder="How many streams to create (1-6)">
            </div>
            
            <div class="toggle-container">
                <label class="toggle">
                    <input type="checkbox" id="autoPlay" checked>
                    <span class="slider"></span>
                </label>
                <label for="autoPlay">Auto-play videos</label>
            </div>
            
            <div class="toggle-container">
                <label class="toggle">
                    <input type="checkbox" id="autoLoop" checked>
                    <span class="slider"></span>
                </label>
                <label for="autoLoop">Auto-loop videos</label>
            </div>
            
            <div class="toggle-container">
                <label class="toggle">
                    <input type="checkbox" id="syncVideos" checked>
                    <span class="slider"></span>
                </label>
                <label for="syncVideos">Sync video playback</label>
            </div>
            
            <div class="controls">
                <button id="generateBtn"><i class="fas fa-sync-alt"></i> Generate Streams</button>
                <button id="playAllBtn"><i class="fas fa-play"></i> Play All</button>
                <button id="pauseAllBtn"><i class="fas fa-pause"></i> Pause All</button>
                <button id="syncBtn"><i class="fas fa-align-left"></i> Sync Now</button>
                <button id="clearAllBtn"><i class="fas fa-trash"></i> Clear All</button>
            </div>
        </div>
        
        <div class="video-container" id="videoContainer">
            <!-- Video streams will be generated here -->
            <div class="loading" id="defaultMessage">
                <i class="fas fa-info-circle"></i> Enter a YouTube URL and click "Generate Streams"
            </div>
        </div>
        
        <div class="generated-link" id="generatedLink">
            <h3><i class="fas fa-share-alt"></i> Share Your Multi-Stream</h3>
            <div class="link-container">
                <input type="text" id="shareLink" readonly>
                <button id="copyLinkBtn"><i class="fas fa-copy"></i> Copy</button>
            </div>
        </div>
        
        <div class="footer">
            <p>SoftWatchLink &copy; 2023 | Powered by YouTube IFrame API</p>
        </div>
    </div>
    
    <div class="notification" id="notification">Link copied to clipboard!</div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <script>
        // Global variables
        let players = [];
        let videoId = '';
        let isYouTubeApiReady = false;
        
        // Wait for YouTube API to load
        function onYouTubeIframeAPIReady() {
            isYouTubeApiReady = true;
            console.log('YouTube API is ready');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const videoUrlInput = document.getElementById('videoUrl');
            const frameCountInput = document.getElementById('frameCount');
            const autoPlayToggle = document.getElementById('autoPlay');
            const autoLoopToggle = document.getElementById('autoLoop');
            const syncVideosToggle = document.getElementById('syncVideos');
            const generateBtn = document.getElementById('generateBtn');
            const playAllBtn = document.getElementById('playAllBtn');
            const pauseAllBtn = document.getElementById('pauseAllBtn');
            const syncBtn = document.getElementById('syncBtn');
            const clearAllBtn = document.getElementById('clearAllBtn');
            const videoContainer = document.getElementById('videoContainer');
            const generatedLink = document.getElementById('generatedLink');
            const shareLinkInput = document.getElementById('shareLink');
            const copyLinkBtn = document.getElementById('copyLinkBtn');
            const notification = document.getElementById('notification');
            const urlError = document.getElementById('urlError');
            const defaultMessage = document.getElementById('defaultMessage');
            
            // Set a sample URL for demonstration
            videoUrlInput.value = 'dQw4w9WgXcQ';
            
            // Generate streams when button is clicked
            generateBtn.addEventListener('click', function() {
                const url = videoUrlInput.value.trim();
                const count = parseInt(frameCountInput.value) || 2;
                
                if (!validateYouTubeUrl(url)) {
                    urlError.style.display = 'block';
                    return;
                }
                
                urlError.style.display = 'none';
                
                if (count < 1 || count > 1000) {
                    alert('Please enter a number between 1 and 1000');
                    return;
                }
                
                videoId = extractVideoId(url);
                generateVideoStreams(videoId, count);
                updateShareLink(videoId, count);
            });
            
            // Play all videos
            playAllBtn.addEventListener('click', function() {
                players.forEach(player => {
                    if (player && typeof player.playVideo === 'function') {
                        player.playVideo();
                    }
                });
            });
            
            // Pause all videos
            pauseAllBtn.addEventListener('click', function() {
                players.forEach(player => {
                    if (player && typeof player.pauseVideo === 'function') {
                        player.pauseVideo();
                    }
                });
            });
            
            // Sync all videos
            syncBtn.addEventListener('click', function() {
                if (players.length > 0 && players[0]) {
                    const currentTime = players[0].getCurrentTime();
                    players.forEach(player => {
                        if (player && typeof player.seekTo === 'function') {
                            player.seekTo(currentTime, true);
                        }
                    });
                }
            });
            
            // Clear all videos
            clearAllBtn.addEventListener('click', function() {
                players.forEach(player => {
                    if (player && typeof player.destroy === 'function') {
                        player.destroy();
                    }
                });
                players = [];
                videoContainer.innerHTML = '';
                defaultMessage.style.display = 'flex';
                generatedLink.style.display = 'none';
            });
            
            // Copy link to clipboard
            copyLinkBtn.addEventListener('click', function() {
                shareLinkInput.select();
                document.execCommand('copy');
                
                // Show notification
                notification.style.display = 'block';
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            });
            
            // Validate YouTube URL
            function validateYouTubeUrl(url) {
                if (!url) return false;
                
                // If it's just a video ID (11 characters)
                if (url.length === 11 && !url.includes(' ')) {
                    return true;
                }
                
                // Check if it's a YouTube URL
                const pattern = /^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.?be)\/.+$/;
                return pattern.test(url);
            }
            
            // Extract video ID from URL
            function extractVideoId(url) {
                if (url.length === 11 && !url.includes(' ')) {
                    return url; // It's already a video ID
                }
                
                const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
                const match = url.match(regExp);
                return (match && match[7].length === 11) ? match[7] : false;
            }
            
            // Generate video streams using YouTube API
            function generateVideoStreams(videoId, count) {
                // Clear existing players
                players.forEach(player => {
                    if (player && typeof player.destroy === 'function') {
                        player.destroy();
                    }
                });
                players = [];
                
                videoContainer.innerHTML = '';
                defaultMessage.style.display = 'none';
                
                for (let i = 0; i < count; i++) {
                    const videoWrapper = document.createElement('div');
                    videoWrapper.className = 'video-wrapper';
                    videoWrapper.id = `video-wrapper-${i}`;
                    
                    // Create video player container
                    const videoPlayer = document.createElement('div');
                    videoPlayer.className = 'video-player';
                    videoPlayer.id = `video-player-${i}`;
                    
                    // Create video info section
                    const videoInfo = document.createElement('div');
                    videoInfo.className = 'video-info';
                    
                    const videoTitle = document.createElement('div');
                    videoTitle.className = 'video-title';
                    videoTitle.textContent = `Stream #${i + 1}`;
                    
                    const videoControls = document.createElement('div');
                    videoControls.className = 'video-controls';
                    
                    const playBtn = document.createElement('button');
                    playBtn.className = 'play-btn';
                    playBtn.innerHTML = '<i class="fas fa-play"></i> Play';
                    playBtn.addEventListener('click', function() {
                        if (players[i]) {
                            players[i].playVideo();
                        }
                    });
                    
                    const pauseBtn = document.createElement('button');
                    pauseBtn.className = 'pause-btn';
                    pauseBtn.innerHTML = '<i class="fas fa-pause"></i> Pause';
                    pauseBtn.addEventListener('click', function() {
                        if (players[i]) {
                            players[i].pauseVideo();
                        }
                    });
                    
                    const volumeControl = document.createElement('div');
                    volumeControl.className = 'volume-control';
                    volumeControl.innerHTML = `
                        <i class="fas fa-volume-up"></i>
                        <input type="range" min="0" max="100" value="100" class="volume-slider">
                    `;
                    
                    const volumeSlider = volumeControl.querySelector('.volume-slider');
                    volumeSlider.addEventListener('input', function() {
                        if (players[i]) {
                            players[i].setVolume(this.value);
                        }
                    });
                    
                    // Assemble the video wrapper
                    videoControls.appendChild(playBtn);
                    videoControls.appendChild(pauseBtn);
                    videoInfo.appendChild(videoTitle);
                    videoInfo.appendChild(videoControls);
                    videoInfo.appendChild(volumeControl);
                    videoWrapper.appendChild(videoPlayer);
                    videoWrapper.appendChild(videoInfo);
                    
                    videoContainer.appendChild(videoWrapper);
                    
                    // Create YouTube player
                    createYouTubePlayer(videoId, i, count);
                }
            }
            
            // Create YouTube player instance
            function createYouTubePlayer(videoId, index, total) {
                // Wait for API to be ready
                const checkAPI = setInterval(() => {
                    if (isYouTubeApiReady) {
                        clearInterval(checkAPI);
                        
                        players[index] = new YT.Player(`video-player-${index}`, {
                            height: '200',
                            width: '100%',
                            videoId: videoId,
                            playerVars: {
                                'autoplay': autoPlayToggle.checked ? 1 : 0,
                                'controls': 1,
                                'rel': 0,
                                'modestbranding': 1,
                                'loop': autoLoopToggle.checked ? 1 : 0
                            },
                            events: {
                                'onReady': onPlayerReady,
                                'onStateChange': onPlayerStateChange
                            }
                        });
                        
                        function onPlayerReady(event) {
                            console.log(`Player ${index} is ready`);
                            
                            // Mute all but first player if sync is enabled
                            if (syncVideosToggle.checked && index > 0) {
                                event.target.mute();
                            }
                            
                            // Sync players if enabled
                            if (syncVideosToggle.checked && index === 0 && players[0]) {
                                const currentTime = players[0].getCurrentTime();
                                setTimeout(() => {
                                    players.forEach((player, i) => {
                                        if (i > 0 && player && typeof player.seekTo === 'function') {
                                            player.seekTo(currentTime, true);
                                        }
                                    });
                                }, 1000);
                            }
                        }
                        
                        function onPlayerStateChange(event) {
                            // Sync players if enabled
                            if (syncVideosToggle.checked && event.data === YT.PlayerState.PLAYING && index === 0) {
                                const currentTime = players[0].getCurrentTime();
                                players.forEach((player, i) => {
                                    if (i > 0 && player && typeof player.seekTo === 'function') {
                                        player.seekTo(currentTime, true);
                                        player.playVideo();
                                    }
                                });
                            }
                        }
                    }
                }, 100);
            }
            
            // Update the share link
            function updateShareLink(videoId, count) {
                const baseUrl = window.location.href.split('?')[0];
                const shareUrl = `${baseUrl}?videoId=${videoId}&count=${count}`;
                shareLinkInput.value = shareUrl;
                generatedLink.style.display = 'block';
            }
            
            // Check for URL parameters on page load
            function checkUrlParams() {
                const urlParams = new URLSearchParams(window.location.search);
                const videoId = urlParams.get('videoId');
                const count = urlParams.get('count');
                
                if (videoId && count) {
                    videoUrlInput.value = videoId;
                    frameCountInput.value = count;
                    generateBtn.click();
                }
            }
            
            // Initialize the page
            checkUrlParams();
        });
    </script>
</body>
</html>